{% extends 'base.html' %}

{% block title %}Post

{% endblock %}

{% block content %}
{% load static %}
    <link rel="stylesheet" href="{% static 'pomapp/post.css' %}">

    <div class="post-header">
        <img class="profile-photo" src={{post.profile_photo}}>
        <h1 class="username">@{{post.user}}</h1>
    </div>
    <div class="post-title">
        <p class="title">{{post.title}}</p>
    </div>

    <div id="post-div"> 
        <img class="post-image" src={{image}}>
    </div>


    <div class="caption">
        <p class="content">{{post.caption}}</p>
    </div>
    <div class="interactions">
        <button class="like">♡ Pom</button> 
        <button class="comment">Comment</button> 
        <button class="share">Share</button> 
    </div>

    <script >
        setTimeout(() => {
            async function fetchLatestData() {
                try {
                    const response = await fetch('/poll_updates');
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    const data = await response.json();
                    
                    if (data.error) {
                        document.getElementById('latest-data').textContent = `Error: ${data.error}`;
                    } else {
                        document.getElementById('latest-data').textContent = `Latest Data: ${data.latest_data.join(', ')}`;
                    }
                } catch (error) {
                    console.error('Error fetching data:', error);
                    document.getElementById('latest-data').textContent = 'Error fetching data. Check console for details.';
                }

            fetchLatestData();
        }

        }, 10)
    </script>


    <div class="nav">
        {% if previous_post_id != -1 %}
            <a href="{% url 'view_post' id=previous_post_id %}">
                <button class="previous">← Previous</button> 
            </a>
        {% endif %}
    
        {% if next_post_id != -1 %}
            <a href="{% url 'view_post' id=next_post_id %}">
                <button class="next">Next →</button>
            </a>
        {% endif %}
    </div>

{% endblock %}